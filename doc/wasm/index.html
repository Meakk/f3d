<!DOCTYPE html>
<html data-theme="dark">

<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.0/css/bulma.min.css">
  <style>
    #main {
      min-height: 70vh;
      border: 1px solid hsl(348, 86%, 43%);
      border-radius: 0.5rem;
      overflow: hidden;
    }
  </style>
</head>

<body>
  <section class="section">
    <div class="container">
      <h1 class="title">F3D Web</h1>
      <p class="subtitle">
        A webassembly build demo
      </p>
    </div>
  </section>
  <section class="section">
    <div class="container" id="main">
      <canvas id="canvas"></canvas>
    </div>
  </section>
  <script type="text/javascript" src="f3d.js"></script>
  <script type="text/javascript">
    let Module = {
      canvas: (() => {
        return document.getElementById("canvas");
      })(),
      onRuntimeInitialized: () => { },
    };

    f3d(Module).then((runtime) => {
      Module.Engine.autoloadPlugins();
      let eng = new Module.Engine();

      eng.getLoader().loadGeometry('/dragon.vtu');

      eng.getOptions().toggle('render.grid.enable');
      eng.getOptions().toggle('render.effect.anti-aliasing');
      eng.getOptions().toggle('render.effect.tone-mapping');

      let main = document.getElementById('main');
      const scale = window.devicePixelRatio;

      eng.getWindow().setSize(scale * main.clientWidth, scale * main.clientHeight);
      eng.getWindow().render();

      eng.getInteractor().start();
    }).catch(error => console.error("F3D internal exception: " + Module.getExceptionMessage(error)));
  </script>
</body>

</html>
